#!/usr/bin/env bash

SRC_GATEWAY=http://localhost:8545/

GAS_PRICE=10000000000
RELAYER_THRESHOLD=3
EXPIRY=100

RELAYER0="0x2bAe5160A67FFE0d2dD9114c521dd51689FDB549"
RELAYER1="0x994354275A3512fc3C54543E1b400ea9dA1d3A0f"
RELAYER2="0xdfAE3230656b0AfBBdc5f4F16F49eEF9398fB51f"

DEPLOYER="0x7F978D99d650a32dFEC1DeaC58b220FF24D30577"
DEPLOYER_PK="4e0793a5b9fa2a6292df57732b91f7c323fae58345899f579a1ff6e4918a6070"

RELAYER_SRC_LIST=$RELAYER0,$RELAYER1,$RELAYER2

SRC_BRIDGE="0xbb46d9697717Efe00928eD6F56C3D67dfB68a29A"
SRC_HANDLER="0x059DA2b6b3e03035306C760C3B453cA603Db3FA1"

SRC_TOKEN="0x0000000000000000000000000000000000001000"
RESOURCE_ID_FRA="0x000000000000000000000000000000c76ebe4a02bbc34786d860b355f5000000"

sleep 10
fn contract-deposit --addr $DEPLOYER --amount 1000000000
sleep 10

cb-sol-cli --url $SRC_GATEWAY --privateKey $DEPLOYER_PK --gasPrice $GAS_PRICE deploy \
    --bridge --erc20Handler \
    --relayers $RELAYER_SRC_LIST \
    --relayerThreshold $RELAYER_THRESHOLD \
    --expiry $EXPIRY \
    --chainId 0

cb-sol-cli --url $SRC_GATEWAY --privateKey $DEPLOYER_PK --gasPrice $GAS_PRICE bridge register-resource \
    --bridge $SRC_BRIDGE \
    --handler $SRC_HANDLER \
    --resourceId $RESOURCE_ID_FRA \
    --targetContract $SRC_TOKEN